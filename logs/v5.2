[0;0m# salt minion cmd.run 'rm -f /etc/dhcp/dhclient-enter-hooks'
[0;36mminion[0;0m:
[0;0m# salt minion cmd.run 'dhclient -r && dhclient'
[0;36mminion[0;0m:
[0;0m# salt minion cmd.run 'cat /etc/resolv.conf'
[0;36mminion[0;0m:
    [0;32m; generated by /sbin/dhclient-script[0;0m
    [0;32msearch ec2.internal[0;0m
    [0;32mnameserver 172.31.0.2[0;0m
[0;0m# salt minion state.sls elb
[0;32mminion:[0;0m
[0;36m----------[0;0m
    [0;36m      ID: API elb[0;0m
    [0;36mFunction: boto_elb.present[0;0m
    [0;36m    Name: api[0;0m
    [0;36m  Result: True[0;0m
    [0;36m Comment: ELB api created. Set health check on ELB api. Added api.auto.dot. Route53 record.[0;0m
    [0;36m Started: 14:14:54.594999[0;0m
    [0;36mDuration: 41780.128 ms[0;0m
[0;36m     Changes:   
              [0;36m----------[0;0m
              [0;36mnew[0;0m:
                  [0;36m----------[0;0m
                  [0;36melb[0;0m:
                      [0;32mapi[0;0m
                  [0;36mhealth_check[0;0m:
                      [0;36m----------[0;0m
                      [0;36mhealthy_threshold[0;0m:
                          [0;1;33m3[0;0m
                      [0;36minterval[0;0m:
                          [0;1;33m30[0;0m
                      [0;36mtarget[0;0m:
                          [0;32mHTTP:80/test[0;0m
                      [0;36mtimeout[0;0m:
                          [0;1;33m5[0;0m
                      [0;36munhealthy_threshold[0;0m:
                          [0;1;33m5[0;0m
                  [0;36mname[0;0m:
                      [0;32mapi.auto.dot.[0;0m
                  [0;36mrecord_type[0;0m:
                      [0;32mCNAME[0;0m
                  [0;36mttl[0;0m:
                      [0;1;33mNone[0;0m
                  [0;36mvalue[0;0m:
                      [0;32mapi-2115460311.us-east-1.elb.amazonaws.com[0;0m
              [0;36mold[0;0m:
                  [0;1;33mNone[0;0m[0;0m
[0;36m
Summary for minion
------------[0;0m
[0;32mSucceeded: 1[0;0m ([0;32mchanged=1[0;0m)
[0;36mFailed:    0[0;0m
[0;36m------------
Total states run:     1[0;0m
[0;0m# 
[0;0m# 
[0;0m# 
[0;0m# salt minion saltutil.sync_grains
[0;36mminion[0;0m:
    [0;32m- grains.ec2_instance_id[0;0m
[0;0m# salt minion grains.get ec2_instance_id
[0;36mminion[0;0m:
    [0;32mi-4c956ed1[0;0m
[0;0m# salt minion mine.update
[0;36mminion[0;0m:
    [0;1;33mTrue[0;0m
[0;0m# 
[0;0m# 
[0;0m# 
[0;0m# salt minion state.sls elb
[0;32mminion:[0;0m
[0;32m----------[0;0m
    [0;32m      ID: API elb[0;0m
    [0;32mFunction: boto_elb.present[0;0m
    [0;32m    Name: api[0;0m
    [0;32m  Result: True[0;0m
    [0;32m Comment: ELB api present. security_groups already set on ELB api.  Availability zones already set on ELB api. Health check already set on ELB api. api.auto.dot. exists.[0;0m
    [0;32m Started: 15:33:03.892239[0;0m
    [0;32mDuration: 360.758 ms[0;0m
[0;32m     Changes:   [0;0m
[0;36m----------[0;0m
    [0;36m      ID: API instances in elb[0;0m
    [0;36mFunction: boto_elb.register_instances[0;0m
    [0;36m    Name: api[0;0m
    [0;36m  Result: True[0;0m
    [0;36m Comment: Load Balancer api has been changed[0;0m
    [0;36m Started: 15:33:04.253222[0;0m
    [0;36mDuration: 94.462 ms[0;0m
[0;36m     Changes:   
              [0;36m----------[0;0m
              [0;36mnew[0;0m:
                  [0;32mi-4c956ed1[0;0m
              [0;36mold[0;0m:[0;0m
[0;36m
Summary for minion
------------[0;0m
[0;32mSucceeded: 2[0;0m ([0;32mchanged=1[0;0m)
[0;36mFailed:    0[0;0m
[0;36m------------
Total states run:     2[0;0m
[0;0m# 
[0;0m# curl http://api-2115460311.us-east-1.elb.amazonaws.com/test
Hello World!
[0;0m# 
[0;0m# nslookup api.auto.dot
Server:		172.31.0.2
Address:	172.31.0.2#53

Non-authoritative answer:
api.auto.dot	canonical name = api-2115460311.us-east-1.elb.amazonaws.com.
Name:	api-2115460311.us-east-1.elb.amazonaws.com
Address: 54.85.103.105
Name:	api-2115460311.us-east-1.elb.amazonaws.com
Address: 52.86.67.176

[0;0m# curl http://http:[K[K[K[K[Kapi.auto.dot/test
Hello World!
